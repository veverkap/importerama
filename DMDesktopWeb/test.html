<html>
	<head>
		<style type="text/css">
			#rounded-corner
{
	font-family: "Lucida Sans Unicode", "Lucida Grande", Sans-Serif;
	font-size: 12px;
	margin: 45px;
	width: 480px;
	text-align: left;
	border-collapse: collapse;
}
#rounded-corner thead th.toplefter
{
	background: #b9c9fe url('left.png') left -1px no-repeat;
}
#rounded-corner thead th.toprighter
{
	background: #b9c9fe url('right.png') right -1px no-repeat;
}
#rounded-corner th
{
	padding: 8px;
	font-weight: normal;
	font-size: 13px;
	color: #039;
	background: #b9c9fe;
}
#rounded-corner td
{
	padding: 8px;
	background: #e8edff;
	border-top: 1px solid #fff;
	color: #669;
}
#rounded-corner tfoot td.rounded-foot-left
{
	background: #e8edff url('botleft.png') left bottom no-repeat;
}
#rounded-corner tfoot td.rounded-foot-right
{
	background: #e8edff url('botright.png') right bottom no-repeat;
}
#rounded-corner tbody tr:hover td
{
	background: #d0dafd;
}
		</style>
		<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
		<script type="text/javascript" src="chain.js"></script>
		<script type="text/javascript">
			var items = new Array();
			$(document).ready(function()
			{
			  $.ajax({
			    type: "GET",
			    url: "log.xml",
			    dataType: "xml",
			    success: parseXml
			  });
			});
			
			function parseXml(data) {
				$(data).find("EventCollection").children().each(function()
				{
					var weather = $(this).find("Weather");
					var item = {
						activityType : parseActivityType(this.nodeName),
						date : $(this).find("Date").text(),
						time : $(this).find("Time").text(),
						type : $(this).find("Type").text(),
						weight : $(this).find("Weight").text(),
						weightUnit : $(this).find("WeightUnit").text(),
						courseName : $(this).find("CourseName").text(),
						distance : $(this).find("Distance").text(),
						distanceUnit : parseDistanceUnits($(this).find("DistanceUnit").text()),
						duration : $(this).find("Duration").text(),
						notes : $(this).find("Notes").text(),
						weather_condition : weather.find("Condition").text(),
						weather_temperature : weather.find("Temperature").text(),
						weather_temperatureunit : weather.find("TemperatureUnit").text()
					}
					
					if (item.activityType != "none") {
						items[items.length] = item;
					}
				});
				//"Run","Bike","Weights"
				$('#parsed').items(items).chain(
				{
					'.completed_at': {
						content: function(d,el) {
							return d.date + " " + d.time;
						}
					},
					'.distance': {
						content: function(d,el) {
							return d.distance + " " + d.distanceUnit;
						}
					}
				});
			}
			
			
			function parseActivityType(name) {
				name = name.toLowerCase();
				if (name == "run") { return "running"; }
				if (name == "bike") { return "cycling"; }
				if (name == "weights") { return "fitness"; }
				return "none";
			}
			
			function parseDistanceUnits(name) {
				name = name.toLowerCase();
				if (name == "mile") {
					return "miles";
				}
				if (name == "kilometer") {
					return "kilometers";
				}
				if (name == "yard") {
					return "yards";
				}
				if (name == "meter") {
					return "meters";
				}
				return "none";
			}
		</script>
	</head>
	<body>
		<table width="100%" id="rounded-corner">
			<thead>
				<tr id="header">
					<th scope="col" class="toplefter" width="75">Type</th>
					<th>Notes</th>
					<th width="140">Date</th>
					<th>Distance</th>
					<th scope="col" class="toprighter">Duration</th>
				</tr>
			</thead>
			<tfoot>
	    		<tr>
        			<td colspan="4" class="rounded-foot-left">&nbsp;</td>
					<td class="rounded-foot-right">&nbsp;</td>
        		</tr>
			</tfoot>
			<tbody id="parsed">
			<tr id="item">
				<td class="activityType"></td>
				<td class="notes"></td>
				<td class="completed_at"></td>
				<td class="distance"></td>
				<td class="duration"></td>
			</tr>
			</tbody>
		</table>
	</body>
</html>