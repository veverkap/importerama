<html>
	<head>
		<title>Sandbox Bridge Test</title>
		<link href="sample.css" rel="stylesheet" type="text/css">
        <script type="text/javascript" src="lib/air/AIRAliases.js"></script>
		<script type="text/javascript" src="lib/scripts/db.js"></script>
        <script type="text/javascript">
            // AIR-related functions created by the developer
			var access_token;
            
            // Reads the content of the application descriptor file
            function getAccessToken() {
                return access_token;
            }

            // Create an object that will be used to expose AIR functionality.
            // to the browser sandbox
            var Exposed = new Object();
            
            // Expose the trace() function.
            Exposed.trace = function(str) {
                air.trace(str);
            }
            
            // Expose a function that reads the application descriptor file.
            Exposed.getAccessToken = getAccessToken;
            
			// Called from the onload event of the body element.
			function doLoad() {
				GetAccessToken();
                // Place the Exposed object on the parentSandboxBridge property of the ui frame's window object.
                var frame = document.getElementById('UI').contentWindow.parentSandboxBridge = Exposed;
				                // Get the functions exposed from the ui frame's sandbox.
                window.reloader = document.getElementById('UI').contentWindow.childSandboxBridge.reloader;
				
				window.setAccessToken = document.getElementById('UI').contentWindow.childSandboxBridge.setAccessToken;
				window.setAccessTokenHeader = document.getElementById('header').contentWindow.childSandboxBridge.setAccessToken;
				setAccessToken(access_token);
				setAccessTokenHeader(access_token);
				//air.trace(access_token);
            }
            
       </script>
	</head>

    <body onload="doLoad();">
    	<iframe id="header"
		   src="http://localhost/whoami.html"
		   sandboxRoot="http://localhost/"
		   documentRoot="app:/"
		   width="100%"
		   height="50px"
		   style="border: 1px solid #000;">
		 </iframe>
        <iframe id="UI"
            src="http://localhost/ui.html"
            sandboxRoot="http://localhost/"
            documentRoot="app:/"
            width="200px" 
            height="100%"
            style="border: 1px solid #000;">
        </iframe>
    </body>
</html>